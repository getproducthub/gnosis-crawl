<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Grub Crawler â€” Agentic Web Crawler</title>
<meta name="description" content="Agentic web crawler with Ghost Protocol, autonomous agent loop, MCP tools, and multi-provider LLM support." />
<meta property="og:title" content="Grubcrawler" />
<meta property="og:description" content="Agentic crawling with Ghost Protocol, MCP tooling, policy gates, and replayable traces." />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://grubcrawler.dev" />
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><text y='28' font-size='28'>ðŸ•·</text></svg>" />
<style>body{margin:0;padding:0;background:#080808;}</style>
</head>
<body>
<div id="root"></div>
<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script type="text/babel">
const { useState, useEffect, useRef } = React;

const NAV_LINKS = ["Features", "Architecture", "API", "Chat"];

const FEATURES = [
  {
    icon: "â—‰",
    title: "Ghost Protocol Bypass",
    desc: "Vision-assisted extraction handles anti-bot walls and blocked renders when DOM extraction is not enough.",
  },
  {
    icon: "â¬¡",
    title: "Autonomous Agent Loop",
    desc: "Bounded planning/execution loop for multi-step browsing, tool orchestration, and task completion with stop controls.",
  },
  {
    icon: "â–³",
    title: "Multi-Provider Rotation",
    desc: "OpenAI, Anthropic, and Ollama adapters with fallback routing to keep runs moving when providers fail.",
  },
  {
    icon: "â—‡",
    title: "Policy Enforcement",
    desc: "Domain gates, private-range blocking, and secret redaction are enforced before fetches and tool calls.",
  },
  {
    icon: "â–£",
    title: "Replayable Traces",
    desc: "Every run emits structured JSON traces so failures, policy denials, and extraction paths can be replayed and audited.",
  },
  {
    icon: "â£",
    title: "MCP Tool Bridge",
    desc: "Crawler, cache, agent, and ghost capabilities are exposed as MCP tools for host-side orchestration.",
  },
];

const API_GROUPS = [
  {
    name: "Core Crawling",
    endpoints: [
      { method: "POST", path: "/api/crawl", desc: "Single URL crawl (HTML + markdown)", status: "Live" },
      { method: "POST", path: "/api/markdown", desc: "Single or multi-URL markdown extraction", status: "Live" },
      { method: "POST", path: "/api/batch", desc: "Batch crawl with job tracking", status: "Live" },
      { method: "POST", path: "/api/raw", desc: "Raw HTML extraction (no markdown)", status: "Live" },
      { method: "GET", path: "/view", desc: "Browser-rendered HTML viewer", status: "Live" },
      { method: "GET", path: "/download", desc: "File download through crawler", status: "Live" },
    ],
  },
  {
    name: "Agent + Ghost",
    endpoints: [
      { method: "POST", path: "/api/agent/run", desc: "Submit task to autonomous agent loop", status: "Live" },
      { method: "GET", path: "/api/agent/status/{run_id}", desc: "Load run status and trace", status: "Live" },
      { method: "POST", path: "/api/agent/ghost", desc: "Ghost Protocol screenshot + vision extract", status: "Live" },
    ],
  },
  {
    name: "Job Management",
    endpoints: [
      { method: "POST", path: "/api/jobs/create", desc: "Generic job submission", status: "Live" },
      { method: "POST", path: "/api/jobs/crawl", desc: "Submit single URL crawl job", status: "Live" },
      { method: "POST", path: "/api/jobs/batch-crawl", desc: "Submit batch crawl job", status: "Live" },
      { method: "POST", path: "/api/jobs/markdown", desc: "Submit markdown-only job", status: "Live" },
      { method: "POST", path: "/api/jobs/process-job", desc: "Cloud Tasks worker endpoint", status: "Live" },
      { method: "POST", path: "/api/wraith", desc: "AI-driven crawl workflow", status: "Placeholder" },
    ],
  },
  {
    name: "Remote Cache",
    endpoints: [
      { method: "POST", path: "/api/cache/search", desc: "Fuzzy search cached content", status: "Live" },
      { method: "GET", path: "/api/cache/list", desc: "List cached document metadata", status: "Live" },
      { method: "GET", path: "/api/cache/doc/{doc_id}", desc: "Fetch one cached document", status: "Live" },
      { method: "POST", path: "/api/cache/upsert", desc: "Upsert cache entries", status: "Live" },
      { method: "POST", path: "/api/cache/prune", desc: "Prune cache entries by TTL/domain", status: "Live" },
    ],
  },
  {
    name: "Session + System",
    endpoints: [
      { method: "GET", path: "/api/sessions/{session_id}/files", desc: "List session files", status: "Live" },
      { method: "GET", path: "/api/sessions/{session_id}/file", desc: "Get specific session file", status: "Live" },
      { method: "GET", path: "/api/sessions/{session_id}/status", desc: "Session progress status", status: "Live" },
      { method: "GET", path: "/api/sessions/{session_id}/results", desc: "Fetch all crawl results", status: "Live" },
      { method: "GET", path: "/api/sessions/{session_id}/screenshots", desc: "List session screenshots", status: "Live" },
      { method: "GET", path: "/health", desc: "Health check + tool count", status: "Live" },
      { method: "GET", path: "/tools", desc: "List registered AHP tools", status: "Live" },
      { method: "GET", path: "/{tool_name}", desc: "Catch-all tool execution route", status: "Live" },
      { method: "WS", path: "/stream/{session_id}", desc: "Live browser stream", status: "Planned" },
      { method: "GET", path: "/stream/{session_id}/mjpeg", desc: "MJPEG stream fallback", status: "Planned" },
    ],
  },
];

const MCP_TOOLS = [
  "crawl_url",
  "crawl_batch",
  "raw_html",
  "download_file",
  "crawl_validate",
  "crawl_search",
  "crawl_cache_list",
  "crawl_remote_search",
  "crawl_remote_cache_list",
  "crawl_remote_cache_doc",
  "agent_run",
  "agent_status",
  "ghost_extract",
  "set_auth_token",
  "crawl_status",
];

const ARCH_LAYERS = [
  { name: "Agent Core", items: ["Bounded State Machine", "Typed Errors", "Tool Dispatcher", "Stop Conditions"] },
  { name: "Provider Adapters", items: ["OpenAI", "Anthropic", "Ollama", "Fallback Rotation"] },
  { name: "Ghost Protocol", items: ["Block Detection", "Screenshot Capture", "Vision Extraction", "Auto Trigger"] },
  { name: "Policy Gates", items: ["Domain Allowlist", "Private Range Deny", "Secret Redaction"] },
  { name: "Observability", items: ["EventBus", "TraceCollector", "RunSummary Persistence", "Replay JSON"] },
  { name: "Infrastructure", items: ["FastAPI Routes", "Playwright Engine", "Local/GCS Storage", "Job Processor"] },
];

function useScrollReveal() {
  const ref = useRef(null);
  const [visible, setVisible] = useState(false);
  useEffect(() => {
    const el = ref.current;
    if (!el) return;
    const obs = new IntersectionObserver(
      ([e]) => { if (e.isIntersecting) { setVisible(true); obs.disconnect(); } },
      { threshold: 0.15 }
    );
    obs.observe(el);
    return () => obs.disconnect();
  }, []);
  return [ref, visible];
}

function RevealDiv({ children, delay = 0, className = "", style = {} }) {
  const [ref, visible] = useScrollReveal();
  return (
    <div
      ref={ref}
      className={className}
      style={{
        ...style,
        opacity: visible ? 1 : 0,
        transform: visible ? "translateY(0)" : "translateY(32px)",
        transition: `opacity 0.7s cubic-bezier(.22,1,.36,1) ${delay}s, transform 0.7s cubic-bezier(.22,1,.36,1) ${delay}s`,
      }}
    >
      {children}
    </div>
  );
}

function GrainOverlay() {
  return (
    <div style={{
      position: "fixed", inset: 0, pointerEvents: "none", zIndex: 9999,
      backgroundImage: `url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E")`,
      opacity: 0.03,
    }} />
  );
}

function Nav({ activeSection, onNav }) {
  const [scrolled, setScrolled] = useState(false);
  useEffect(() => {
    const h = () => setScrolled(window.scrollY > 40);
    window.addEventListener("scroll", h, { passive: true });
    return () => window.removeEventListener("scroll", h);
  }, []);

  return (
    <nav style={{
      position: "fixed", top: 0, left: 0, right: 0, zIndex: 100,
      padding: "0 clamp(1.5rem, 4vw, 4rem)",
      height: 64,
      display: "flex", alignItems: "center", justifyContent: "space-between",
      background: scrolled ? "rgba(8,8,8,0.85)" : "transparent",
      backdropFilter: scrolled ? "blur(16px) saturate(1.4)" : "none",
      borderBottom: scrolled ? "1px solid rgba(255,255,255,0.06)" : "1px solid transparent",
      transition: "all 0.4s ease",
    }}>
      <div style={{ display: "flex", alignItems: "center", gap: 10 }}>
        <span style={{
          fontFamily: "'IBM Plex Mono', monospace",
          fontSize: 20, fontWeight: 700, letterSpacing: "-0.5px",
          color: "#c8ff00",
        }}>
          GRUB<span style={{ color: "rgba(255,255,255,0.35)", fontWeight: 500 }}>CRAWLER</span>
        </span>
      </div>
      <div style={{ display: "flex", gap: "clamp(16px, 3vw, 36px)", alignItems: "center" }}>
        {NAV_LINKS.map((l) => (
          <button
            key={l}
            onClick={() => onNav(l.toLowerCase())}
            style={{
              background: "none", border: "none", cursor: "pointer",
              fontFamily: "'IBM Plex Mono', monospace",
              fontSize: 12, letterSpacing: "0.08em", textTransform: "uppercase",
              color: activeSection === l.toLowerCase() ? "#c8ff00" : "rgba(255,255,255,0.45)",
              transition: "color 0.25s",
              padding: "4px 0",
            }}
          >
            {l}
          </button>
        ))}
      </div>
    </nav>
  );
}

function Hero({ introDone, onIntroDone, skipIntro }) {
  const [loaded, setLoaded] = useState(false);
  const [bootPhase, setBootPhase] = useState(() => (skipIntro ? "stable" : "idle"));
  const [typedVersion, setTypedVersion] = useState(() => (skipIntro ? "2.0" : ""));
  useEffect(() => { requestAnimationFrame(() => setLoaded(true)); }, []);
  useEffect(() => {
    if (skipIntro) return;
    const timers = [];
    const steps = ["2", "2.", "2.0"];
    const idleMs = 3500;
    const liteShakeMs = 2200;
    const hardShakeMs = 1800;
    const typeStepMs = 420;
    const fadeMs = 1800;

    timers.push(setTimeout(() => setBootPhase("shake-lite"), idleMs));
    timers.push(setTimeout(() => setBootPhase("shake-hard"), idleMs + liteShakeMs));
    timers.push(setTimeout(() => {
      setBootPhase("typing");
      let stepIndex = 0;
      const typeTimer = setInterval(() => {
        setTypedVersion(steps[stepIndex] || "2.0");
        stepIndex += 1;
        if (stepIndex >= steps.length) {
          clearInterval(typeTimer);
          setBootPhase("fading");
          timers.push(setTimeout(() => setBootPhase("stable"), fadeMs));
        }
      }, typeStepMs);
      timers.push(typeTimer);
    }, idleMs + liteShakeMs + hardShakeMs));

    return () => {
      timers.forEach(t => clearTimeout(t));
      timers.forEach(t => clearInterval(t));
    };
  }, [skipIntro]);
  useEffect(() => {
    if (bootPhase !== "stable" || introDone) return;
    const revealTimer = setTimeout(() => onIntroDone?.(), 120);
    return () => clearTimeout(revealTimer);
  }, [bootPhase, introDone, onIntroDone]);
  const titleText = `GRUB${typedVersion ? ` ${typedVersion}` : ""}`;

  return (
    <section style={{
      minHeight: "100vh", display: "flex", flexDirection: "column",
      justifyContent: "center", alignItems: "center",
      padding: "120px clamp(1.5rem, 5vw, 6rem) 80px",
      position: "relative", overflow: "hidden",
    }}>
      <div style={{
        position: "absolute", top: "-30%", left: "50%", transform: "translateX(-50%)",
        width: "140vw", height: "80vh",
        background: "radial-gradient(ellipse at center, rgba(200,255,0,0.06) 0%, transparent 65%)",
        pointerEvents: "none",
      }} />
      <div style={{
        position: "absolute", inset: 0, pointerEvents: "none",
        backgroundImage: `
          linear-gradient(rgba(255,255,255,0.015) 1px, transparent 1px),
          linear-gradient(90deg, rgba(255,255,255,0.015) 1px, transparent 1px)
        `,
        backgroundSize: "80px 80px",
      }} />

      <div style={{
        opacity: loaded ? 1 : 0,
        transform: loaded ? "translateY(0)" : "translateY(24px)",
        transition: "all 1s cubic-bezier(.22,1,.36,1) 0.1s",
        textAlign: "center", position: "relative", zIndex: 1,
      }}>
        <div style={{
          fontFamily: "'IBM Plex Mono', monospace",
          fontSize: 11, letterSpacing: "0.25em", textTransform: "uppercase",
          color: "rgba(200,255,0,0.5)", marginBottom: 28,
          opacity: introDone ? 1 : 0,
          transform: introDone ? "translateY(0)" : "translateY(8px)",
          transition: "opacity 1s ease, transform 1s ease",
        }}>
          Reclaimed &middot; Rebuilt &middot; Open Source
        </div>

        <h1 style={{
          fontFamily: "'Space Mono', monospace",
          fontSize: "clamp(3.2rem, 10vw, 8rem)",
          fontWeight: 700, letterSpacing: "-0.04em",
          lineHeight: 0.9, margin: 0,
          color: "#ffe000",
          textShadow: "0 0 120px rgba(200,255,0,0.15), 0 0 40px rgba(200,255,0,0.08)",
        }}>
          <span
            className={`hero-mark phase-${bootPhase}`}
          >
            {titleText}
          </span>
        </h1>

        <div style={{
          opacity: introDone ? 1 : 0,
          transform: introDone ? "translateY(0)" : "translateY(12px)",
          transition: "opacity 1s ease, transform 1s ease",
          pointerEvents: introDone ? "auto" : "none",
        }}>
          <p style={{
            fontFamily: "'IBM Plex Mono', monospace",
            fontSize: "clamp(0.85rem, 1.8vw, 1.15rem)",
            color: "rgba(255,255,255,0.55)", maxWidth: 580,
            lineHeight: 1.7, margin: "0 auto 0",
            letterSpacing: "0.01em",
          }}>
            The world&apos;s only agentic web crawler.<br />
            Endpoints &middot; Ghost Protocol &middot; MCP Tools<br />
            Distributed extraction for hostile web surfaces.
          </p>
          <div style={{
            marginTop: 18,
            fontFamily: "'IBM Plex Mono', monospace",
            fontSize: 11,
            letterSpacing: "0.12em",
            textTransform: "uppercase",
            color: "rgba(255,255,255,0.35)",
          }}>
            License &middot; Python &middot; FastAPI &middot; Playwright &middot; MCP &middot; Ghost Protocol
          </div>

          <div style={{
            display: "flex", gap: 16, justifyContent: "center",
            marginTop: 48, flexWrap: "wrap",
          }}>
            <button style={{
              fontFamily: "'IBM Plex Mono', monospace",
              fontSize: 13, fontWeight: 600,
              padding: "14px 36px",
              background: "#c8ff00", color: "#080808",
              border: "none", cursor: "pointer",
              letterSpacing: "0.06em", textTransform: "uppercase",
              transition: "all 0.25s",
            }}
              onClick={() => document.getElementById("chat")?.scrollIntoView({ behavior: "smooth" })}
              onMouseEnter={e => { e.target.style.background = "#dfff4f"; e.target.style.transform = "translateY(-2px)"; }}
              onMouseLeave={e => { e.target.style.background = "#c8ff00"; e.target.style.transform = "translateY(0)"; }}
            >
              Get Started
            </button>
            <button style={{
              fontFamily: "'IBM Plex Mono', monospace",
              fontSize: 13, fontWeight: 500,
              padding: "14px 36px",
              background: "transparent",
              color: "rgba(255,255,255,0.6)",
              border: "1px solid rgba(255,255,255,0.12)",
              cursor: "pointer",
              letterSpacing: "0.06em", textTransform: "uppercase",
              transition: "all 0.25s",
            }}
              onClick={() => window.open("https://github.com/deepbluedynamics/gnosis-crawl", "_blank", "noopener,noreferrer")}
              onMouseEnter={e => { e.target.style.borderColor = "rgba(200,255,0,0.4)"; e.target.style.color = "#c8ff00"; }}
              onMouseLeave={e => { e.target.style.borderColor = "rgba(255,255,255,0.12)"; e.target.style.color = "rgba(255,255,255,0.6)"; }}
            >
              View Source
            </button>
          </div>
        </div>
      </div>

      <div style={{
        position: "absolute", bottom: 32, left: "50%", transform: "translateX(-50%)",
        opacity: loaded && introDone ? 0.3 : 0, transition: "opacity 1.2s ease",
      }}>
        <div style={{
          width: 1, height: 48, background: "linear-gradient(to bottom, rgba(200,255,0,0.6), transparent)",
        }} />
      </div>
    </section>
  );
}

function Features() {
  return (
    <section id="features" style={{
      padding: "120px clamp(1.5rem, 5vw, 6rem)",
      maxWidth: 1200, margin: "0 auto",
    }}>
      <RevealDiv>
        <div style={{
          fontFamily: "'IBM Plex Mono', monospace",
          fontSize: 11, letterSpacing: "0.25em", textTransform: "uppercase",
          color: "rgba(200,255,0,0.45)", marginBottom: 16,
        }}>
          Capabilities
        </div>
        <h2 style={{
          fontFamily: "'Space Mono', monospace",
          fontSize: "clamp(2rem, 5vw, 3.2rem)",
          fontWeight: 700, letterSpacing: "-0.03em",
          color: "#fff", margin: "0 0 64px",
        }}>
          Why Grub.
        </h2>
      </RevealDiv>

      <div style={{
        display: "grid",
        gridTemplateColumns: "repeat(auto-fit, minmax(min(100%, 320px), 1fr))",
        gap: 2,
      }}>
        {FEATURES.map((f, i) => (
          <RevealDiv key={f.title} delay={i * 0.08}>
            <FeatureCard feature={f} />
          </RevealDiv>
        ))}
      </div>
    </section>
  );
}

function FeatureCard({ feature }) {
  const [hov, setHov] = useState(false);
  return (
    <div
      onMouseEnter={() => setHov(true)}
      onMouseLeave={() => setHov(false)}
      style={{
        padding: "40px 36px",
        background: hov ? "rgba(200,255,0,0.03)" : "rgba(255,255,255,0.02)",
        border: `1px solid ${hov ? "rgba(200,255,0,0.12)" : "rgba(255,255,255,0.04)"}`,
        transition: "all 0.35s ease",
        cursor: "default",
        height: "100%",
        boxSizing: "border-box",
      }}
    >
      <div style={{
        fontFamily: "'Space Mono', monospace",
        fontSize: 28, color: "#c8ff00",
        marginBottom: 20, opacity: 0.7,
      }}>
        {feature.icon}
      </div>
      <h3 style={{
        fontFamily: "'IBM Plex Mono', monospace",
        fontSize: 15, fontWeight: 600,
        color: "#fff", margin: "0 0 12px",
        letterSpacing: "0.02em",
      }}>
        {feature.title}
      </h3>
      <p style={{
        fontFamily: "'IBM Plex Sans', sans-serif",
        fontSize: 14, lineHeight: 1.7,
        color: "rgba(255,255,255,0.4)", margin: 0,
      }}>
        {feature.desc}
      </p>
    </div>
  );
}

function Architecture() {
  return (
    <section id="architecture" style={{
      padding: "120px clamp(1.5rem, 5vw, 6rem)",
      maxWidth: 1200, margin: "0 auto",
    }}>
      <RevealDiv>
        <div style={{
          fontFamily: "'IBM Plex Mono', monospace",
          fontSize: 11, letterSpacing: "0.25em", textTransform: "uppercase",
          color: "rgba(200,255,0,0.45)", marginBottom: 16,
        }}>
          Internals
        </div>
        <h2 style={{
          fontFamily: "'Space Mono', monospace",
          fontSize: "clamp(2rem, 5vw, 3.2rem)",
          fontWeight: 700, letterSpacing: "-0.03em",
          color: "#fff", margin: "0 0 64px",
        }}>
          Agent architecture.
        </h2>
      </RevealDiv>

      <div style={{ display: "flex", flexDirection: "column", gap: 2 }}>
        {ARCH_LAYERS.map((layer, i) => (
          <RevealDiv key={layer.name} delay={i * 0.07}>
            <div style={{
              display: "flex",
              flexWrap: "wrap",
              alignItems: "center",
              padding: "28px 32px",
              background: `rgba(200,255,0,${0.015 + i * 0.006})`,
              border: "1px solid rgba(255,255,255,0.04)",
              gap: 16,
            }}>
              <div style={{
                fontFamily: "'IBM Plex Mono', monospace",
                fontSize: 13, fontWeight: 600,
                color: "#c8ff00", letterSpacing: "0.04em",
                opacity: 0.8, minWidth: 160,
              }}>
                {String(i).padStart(2, "0")} {layer.name}
              </div>
              <div style={{
                display: "flex", gap: 12, flexWrap: "wrap", flex: 1,
              }}>
                {layer.items.map(item => (
                  <span key={item} style={{
                    fontFamily: "'IBM Plex Mono', monospace",
                    fontSize: 12,
                    padding: "6px 14px",
                    background: "rgba(0,0,0,0.3)",
                    border: "1px solid rgba(255,255,255,0.06)",
                    color: "rgba(255,255,255,0.5)",
                    letterSpacing: "0.02em",
                    whiteSpace: "nowrap",
                  }}>
                    {item}
                  </span>
                ))}
              </div>
            </div>
          </RevealDiv>
        ))}
      </div>

      <RevealDiv delay={0.3}>
        <div style={{
          marginTop: 64,
          display: "grid",
          gridTemplateColumns: "repeat(auto-fit, minmax(min(100%, 300px), 1fr))",
          gap: 2,
        }}>
          {[
            { mode: "A", title: "Endpoint Mode", desc: "Direct REST + MCP tool calls for deterministic extraction and orchestration.", color: "#c8ff00" },
            { mode: "B", title: "Agent Mode B", desc: "Autonomous loop runs plan -> execute -> observe with policy gates and trace output.", color: "#00ffc8" },
          ].map(m => (
            <div key={m.mode} style={{
              padding: "40px 36px",
              background: "rgba(255,255,255,0.02)",
              border: "1px solid rgba(255,255,255,0.04)",
            }}>
              <div style={{
                fontFamily: "'Space Mono', monospace",
                fontSize: 48, fontWeight: 700,
                color: m.color, opacity: 0.2,
                lineHeight: 1, marginBottom: 16,
              }}>
                {m.mode}
              </div>
              <h3 style={{
                fontFamily: "'IBM Plex Mono', monospace",
                fontSize: 15, fontWeight: 600,
                color: "#fff", margin: "0 0 10px",
              }}>
                {m.title}
              </h3>
              <p style={{
                fontFamily: "'IBM Plex Sans', sans-serif",
                fontSize: 14, lineHeight: 1.7,
                color: "rgba(255,255,255,0.4)", margin: 0,
              }}>
                {m.desc}
              </p>
            </div>
          ))}
        </div>
      </RevealDiv>
    </section>
  );
}

function ApiSection() {
  const [hovered, setHovered] = useState(null);
  let endpointIndex = 0;

  return (
    <section id="api" style={{
      padding: "120px clamp(1.5rem, 5vw, 6rem)",
      maxWidth: 1200, margin: "0 auto",
    }}>
      <RevealDiv>
        <div style={{
          fontFamily: "'IBM Plex Mono', monospace",
          fontSize: 11, letterSpacing: "0.25em", textTransform: "uppercase",
          color: "rgba(200,255,0,0.45)", marginBottom: 16,
        }}>
          Endpoints
        </div>
        <h2 style={{
          fontFamily: "'Space Mono', monospace",
          fontSize: "clamp(2rem, 5vw, 3.2rem)",
          fontWeight: 700, letterSpacing: "-0.03em",
          color: "#fff", margin: "0 0 64px",
        }}>
          Endpoints and MCP tools.
        </h2>
      </RevealDiv>

      <div style={{ display: "flex", flexDirection: "column" }}>
        {API_GROUPS.map((group, gi) => (
          <div key={group.name}>
            <RevealDiv delay={gi * 0.08}>
              <div style={{
                padding: "14px 24px",
                borderTop: gi === 0 ? "1px solid rgba(255,255,255,0.06)" : "1px solid rgba(255,255,255,0.04)",
                borderBottom: "1px solid rgba(255,255,255,0.04)",
                background: "rgba(255,255,255,0.02)",
                fontFamily: "'IBM Plex Mono', monospace",
                fontSize: 11,
                letterSpacing: "0.12em",
                textTransform: "uppercase",
                color: "rgba(200,255,0,0.75)",
              }}>
                {group.name}
              </div>
            </RevealDiv>
            {group.endpoints.map((ep) => {
              endpointIndex += 1;
              const rowIndex = endpointIndex;
              return (
                <RevealDiv key={group.name + ep.path + ep.method} delay={0.06 + rowIndex * 0.02}>
                  <div
                    onMouseEnter={() => setHovered(rowIndex)}
                    onMouseLeave={() => setHovered(null)}
                    style={{
                      display: "flex",
                      flexWrap: "wrap",
                      alignItems: "center",
                      padding: "18px 24px",
                      gap: 16,
                      borderBottom: "1px solid rgba(255,255,255,0.04)",
                      background: hovered === rowIndex ? "rgba(200,255,0,0.02)" : "transparent",
                      transition: "background 0.25s",
                      cursor: "default",
                    }}
                  >
                    <span style={{
                      fontFamily: "'IBM Plex Mono', monospace",
                      fontSize: 11, fontWeight: 700,
                      color: ep.method === "POST" ? "#c8ff00" : (ep.method === "WS" ? "#ff9a00" : "#00c8ff"),
                      letterSpacing: "0.08em",
                      opacity: 0.8,
                      minWidth: 52,
                    }}>
                      {ep.method}
                    </span>
                    <span style={{
                      fontFamily: "'IBM Plex Mono', monospace",
                      fontSize: 14,
                      color: "rgba(255,255,255,0.75)",
                      flex: 1, minWidth: 200,
                    }}>
                      {ep.path}
                    </span>
                    <span style={{
                      fontFamily: "'IBM Plex Sans', sans-serif",
                      fontSize: 13,
                      color: "rgba(255,255,255,0.35)",
                    }}>
                      {ep.desc}
                    </span>
                    <span style={{
                      marginLeft: "auto",
                      fontFamily: "'IBM Plex Mono', monospace",
                      fontSize: 10,
                      letterSpacing: "0.06em",
                      textTransform: "uppercase",
                      color: ep.status === "Live" ? "rgba(200,255,0,0.7)" : "rgba(255,154,0,0.75)",
                      border: `1px solid ${ep.status === "Live" ? "rgba(200,255,0,0.25)" : "rgba(255,154,0,0.35)"}`,
                      padding: "3px 8px",
                      flexShrink: 0,
                    }}>
                      {ep.status}
                    </span>
                  </div>
                </RevealDiv>
              );
            })}
          </div>
        ))}
      </div>

      <RevealDiv delay={0.3}>
        <pre style={{
          marginTop: 56,
          padding: "32px 36px",
          background: "rgba(255,255,255,0.02)",
          border: "1px solid rgba(255,255,255,0.06)",
          fontFamily: "'IBM Plex Mono', monospace",
          fontSize: 13, lineHeight: 2,
          color: "rgba(255,255,255,0.45)",
          overflow: "auto",
          whiteSpace: "pre-wrap",
          wordBreak: "break-all",
        }}>
          <span style={{ color: "rgba(255,255,255,0.2)" }}>$</span>{" "}
          <span style={{ color: "#c8ff00" }}>curl</span>{" "}
          -X POST https://grubcrawler.dev/api/agent/run \{"\n"}
          {"  "}-H <span style={{ color: "#00c8ff" }}>"Content-Type: application/json"</span> \{"\n"}
          {"  "}-d <span style={{ color: "#00c8ff" }}>{"'{\"task\": \"Find pricing on example.com\", \"max_steps\": 10}'"}
          </span>
        </pre>
      </RevealDiv>
      <RevealDiv delay={0.36}>
        <div style={{
          marginTop: 24,
          border: "1px solid rgba(255,255,255,0.06)",
          background: "rgba(255,255,255,0.015)",
          padding: "24px",
        }}>
          <div style={{
            fontFamily: "'IBM Plex Mono', monospace",
            fontSize: 11, letterSpacing: "0.14em", textTransform: "uppercase",
            color: "rgba(200,255,0,0.65)", marginBottom: 14,
          }}>
            MCP Tools
          </div>
          <div style={{ display: "flex", flexWrap: "wrap", gap: 10 }}>
            {MCP_TOOLS.map((tool) => (
              <span key={tool} style={{
                fontFamily: "'IBM Plex Mono', monospace",
                fontSize: 12,
                padding: "6px 12px",
                border: "1px solid rgba(200,255,0,0.2)",
                background: "rgba(200,255,0,0.04)",
                color: "rgba(255,255,255,0.68)",
              }}>
                {tool}
              </span>
            ))}
          </div>
        </div>
      </RevealDiv>
    </section>
  );
}

function ChatSection() {
  const [messages, setMessages] = useState([
    { role: "system", text: "Grubcrawler Chat is coming. An embedded assistant that can crawl, search, and summarize live web content â€” right here." },
  ]);
  const [input, setInput] = useState("");
  const [focused, setFocused] = useState(false);
  const messagesEndRef = useRef(null);

  useEffect(() => {
    if (messages.length > 1) {
      messagesEndRef.current?.scrollIntoView({ behavior: "smooth", block: "nearest" });
    }
  }, [messages]);

  return (
    <section id="chat" style={{
      padding: "120px clamp(1.5rem, 5vw, 6rem)",
      maxWidth: 1200, margin: "0 auto",
    }}>
      <RevealDiv>
        <div style={{
          fontFamily: "'IBM Plex Mono', monospace",
          fontSize: 11, letterSpacing: "0.25em", textTransform: "uppercase",
          color: "rgba(200,255,0,0.45)", marginBottom: 16,
        }}>
          Coming Soon
        </div>
        <h2 style={{
          fontFamily: "'Space Mono', monospace",
          fontSize: "clamp(2rem, 5vw, 3.2rem)",
          fontWeight: 700, letterSpacing: "-0.03em",
          color: "#fff", margin: "0 0 20px",
        }}>
          Talk to the crawler.
        </h2>
        <p style={{
          fontFamily: "'IBM Plex Sans', sans-serif",
          fontSize: 16, lineHeight: 1.7,
          color: "rgba(255,255,255,0.4)",
          maxWidth: 560, margin: "0 0 48px",
        }}>
          An embedded chat window powered by Grubcrawler's agentic engine. Ask it to crawl, extract, compare, and summarize â€” conversationally.
        </p>
      </RevealDiv>

      <RevealDiv delay={0.15}>
        <div style={{
          border: "1px solid rgba(255,255,255,0.06)",
          background: "rgba(255,255,255,0.015)",
          maxWidth: 640,
          overflow: "hidden",
        }}>
          <div style={{
            padding: "16px 24px",
            borderBottom: "1px solid rgba(255,255,255,0.06)",
            display: "flex", alignItems: "center", gap: 10,
          }}>
            <div style={{
              width: 8, height: 8, borderRadius: "50%",
              background: "#c8ff00", opacity: 0.6,
              animation: "pulse 2s ease-in-out infinite",
            }} />
            <span style={{
              fontFamily: "'IBM Plex Mono', monospace",
              fontSize: 12, color: "rgba(255,255,255,0.4)",
              letterSpacing: "0.06em", textTransform: "uppercase",
            }}>
              grubcrawler-agent
            </span>
            <span style={{
              fontFamily: "'IBM Plex Mono', monospace",
              fontSize: 10, color: "rgba(255,255,255,0.15)",
              marginLeft: "auto",
            }}>
              preview
            </span>
          </div>

          <div style={{
            padding: "24px",
            minHeight: 200, maxHeight: 360,
            display: "flex", flexDirection: "column", gap: 16,
            overflowY: "auto",
          }}>
            {messages.map((m, i) => (
              <div key={i} style={{
                fontFamily: "'IBM Plex Sans', sans-serif",
                fontSize: 14, lineHeight: 1.7,
                color: m.role === "system" ? "rgba(255,255,255,0.35)" : "rgba(255,255,255,0.7)",
                padding: "14px 18px",
                background: m.role === "system" ? "rgba(200,255,0,0.03)" : "rgba(255,255,255,0.03)",
                borderLeft: m.role === "system" ? "2px solid rgba(200,255,0,0.2)" : "2px solid rgba(255,255,255,0.1)",
              }}>
                {m.text}
              </div>
            ))}
            <div ref={messagesEndRef} />
          </div>

          <div style={{
            padding: "16px 24px",
            borderTop: "1px solid rgba(255,255,255,0.06)",
          }}>
            <div style={{
              display: "flex", gap: 12, alignItems: "center",
              padding: "12px 16px",
              border: `1px solid ${focused ? "rgba(200,255,0,0.25)" : "rgba(255,255,255,0.06)"}`,
              background: "rgba(0,0,0,0.2)",
              transition: "border-color 0.25s",
            }}>
              <span style={{
                fontFamily: "'IBM Plex Mono', monospace",
                fontSize: 13, color: "rgba(200,255,0,0.3)",
              }}>
                &gt;
              </span>
              <input
                value={input}
                onChange={e => setInput(e.target.value)}
                onFocus={() => setFocused(true)}
                onBlur={() => setFocused(false)}
                onKeyDown={e => {
                  if (e.key === "Enter" && input.trim()) {
                    setMessages(prev => [
                      ...prev,
                      { role: "user", text: input.trim() },
                      { role: "system", text: "Chat is not yet connected. This is a preview of the upcoming Grubcrawler conversational interface." },
                    ]);
                    setInput("");
                  }
                }}
                placeholder="Crawl https://example.com and summarize..."
                style={{
                  flex: 1, background: "none", border: "none", outline: "none",
                  fontFamily: "'IBM Plex Mono', monospace",
                  fontSize: 13, color: "rgba(255,255,255,0.6)",
                  minWidth: 0,
                }}
              />
              <span style={{
                fontFamily: "'IBM Plex Mono', monospace",
                fontSize: 10, color: "rgba(255,255,255,0.15)",
                padding: "3px 8px",
                border: "1px solid rgba(255,255,255,0.06)",
                flexShrink: 0,
              }}>
                enter
              </span>
            </div>
          </div>
        </div>
      </RevealDiv>
    </section>
  );
}

function Footer() {
  return (
    <footer style={{
      padding: "64px clamp(1.5rem, 5vw, 6rem) 48px",
      borderTop: "1px solid rgba(255,255,255,0.04)",
      display: "flex", justifyContent: "space-between", alignItems: "end",
      flexWrap: "wrap", gap: 24,
      maxWidth: 1200, margin: "0 auto",
    }}>
      <div>
        <div style={{
          fontFamily: "'IBM Plex Mono', monospace",
          fontSize: 14, fontWeight: 700,
          color: "#c8ff00", marginBottom: 8,
        }}>
          GRUBCRAWLER
        </div>
        <p style={{
          fontFamily: "'IBM Plex Sans', sans-serif",
          fontSize: 13, color: "rgba(255,255,255,0.25)",
          margin: 0, lineHeight: 1.6,
        }}>
          Spiritual successor to Grub (est. 2000).<br />
          The distributed web crawler, reborn. 2026.
        </p>
      </div>
      <div style={{
        fontFamily: "'IBM Plex Mono', monospace",
        fontSize: 11, color: "rgba(255,255,255,0.15)",
        letterSpacing: "0.06em",
      }}>
        Open Source &middot; Gnosis Project License
      </div>
    </footer>
  );
}

function GrubSite() {
  const [activeSection, setActiveSection] = useState("");
  const [introDone, setIntroDone] = useState(() => {
    try {
      return window.localStorage.getItem("grub_intro_seen_v1") === "1";
    } catch {
      return false;
    }
  });

  useEffect(() => {
    const sections = ["features", "architecture", "api", "chat"];
    const obs = new IntersectionObserver(
      (entries) => {
        entries.forEach(e => {
          if (e.isIntersecting) setActiveSection(e.target.id);
        });
      },
      { threshold: 0.3 }
    );
    sections.forEach(id => {
      const el = document.getElementById(id);
      if (el) obs.observe(el);
    });
    return () => obs.disconnect();
  }, []);

  const handleNav = (id) => {
    document.getElementById(id)?.scrollIntoView({ behavior: "smooth" });
  };

  useEffect(() => {
    if (!introDone) return;
    try {
      window.localStorage.setItem("grub_intro_seen_v1", "1");
    } catch {
      // ignore storage failures
    }
  }, [introDone]);

  return (
    <div style={{
      background: "#080808",
      color: "#fff",
      minHeight: "100vh",
      overflowX: "hidden",
    }}>
      <style>{`
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&family=IBM+Plex+Sans:wght@400;500;600&family=Space+Mono:wght@400;700&display=swap');
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        ::selection { background: rgba(200,255,0,0.25); color: #fff; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #080808; }
        ::-webkit-scrollbar-thumb { background: rgba(200,255,0,0.15); }
        input::placeholder { color: rgba(255,255,255,0.2) !important; }
        @keyframes pulse {
          0%, 100% { opacity: 0.6; }
          50% { opacity: 1; }
        }
        .hero-mark {
          display: inline-block;
          white-space: nowrap;
        }
        .hero-mark.phase-idle {
          color: #39ff14;
          text-shadow: 0 0 20px rgba(57,255,20,0.28);
        }
        .hero-mark.phase-shake-lite {
          color: #39ff14;
          text-shadow: 0 0 24px rgba(57,255,20,0.32);
          animation: toxicShakeLite 0.24s steps(2, end) infinite;
        }
        .hero-mark.phase-shake-hard {
          color: #39ff14;
          text-shadow: 0 0 26px rgba(57,255,20,0.4);
          animation: toxicShakeHard 0.16s steps(2, end) infinite;
        }
        .hero-mark.phase-typing {
          color: #39ff14;
          text-shadow: 0 0 26px rgba(57,255,20,0.42);
          animation: toxicShakeHard 0.16s steps(2, end) infinite;
        }
        .hero-mark.phase-fading {
          color: #39ff14;
          text-shadow: 0 0 24px rgba(57,255,20,0.35);
          animation: toxicShakeHard 0.16s steps(2, end) infinite, fadeToYellow 1.8s linear forwards;
        }
        .hero-mark.phase-stable {
          color: #ffe000;
          text-shadow: 0 0 22px rgba(255,224,0,0.38);
        }
        @keyframes toxicShakeLite {
          0%, 100% {
            transform: translate(0, 0);
          }
          25% {
            transform: translate(-1px, 0px);
          }
          50% {
            transform: translate(1px, 0px);
          }
          75% {
            transform: translate(0px, -1px);
          }
        }
        @keyframes toxicShakeHard {
          0%, 100% {
            transform: translate(0, 0);
          }
          20% {
            transform: translate(-2px, 0px);
          }
          40% {
            transform: translate(2px, 0px);
          }
          60% {
            transform: translate(0px, -2px);
          }
          80% {
            transform: translate(0px, 2px);
          }
        }
        @keyframes fadeToYellow {
          0% {
            color: #39ff14;
            text-shadow: 0 0 24px rgba(57,255,20,0.35);
          }
          100% {
            color: #ffe000;
            text-shadow: 0 0 22px rgba(255,224,0,0.38);
          }
        }
      `}</style>
      <GrainOverlay />
      <div style={{
        opacity: introDone ? 1 : 0,
        transition: "opacity 1s ease",
        pointerEvents: introDone ? "auto" : "none",
      }}>
        <Nav activeSection={activeSection} onNav={handleNav} />
      </div>
      <Hero introDone={introDone} onIntroDone={() => setIntroDone(true)} skipIntro={introDone} />
      <div style={{
        opacity: introDone ? 1 : 0,
        transition: "opacity 1.1s ease",
        pointerEvents: introDone ? "auto" : "none",
      }}>
        <Features />
        <Architecture />
        <ApiSection />
        <ChatSection />
        <Footer />
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<GrubSite />);
</script>
</body>
</html>
